<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" >
    <title>External API UI Extension Sample</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
    <link rel="stylesheet" href="https://contentful.github.io/ui-extensions-sdk/cf-extension.css">
    <script src="https://contentful.github.io/ui-extensions-sdk/cf-extension-api.js"></script>
</head>

<body>
    <div class="cf-form-field">
        <div class="cf-form-field">
          <textarea id="bacon_text" class="cf-form-input"></textarea>
        </div>
        <div class="cf-form-option">
            <input type="checkbox" id="startWithLorem" >
            <label for="startWithLorem">Start with Bacon ipsum dolor sit amet</label>
        </div>
        <div class="cf-form-field">
           <label>Number of Paragraphs</label>
          <select class="cf-form-input" id="paraStatus">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
          </select>
        </div>
        <button id='bacon_button' class="cf-btn-primary">Generate Bacon</button>
        <div class="cf-form-hint">
            Get Bacon Themed Loren Ipsum Text.
        </div>
    </div>

    <script type="text/javascript">
        window.contentfulExtension.init(function (api) {
            api.window.startAutoResizer();
            var value = api.field.getValue();
            $("#bacon_text").val(value);

            var baconUri = "https://baconipsum.com/api/?type=meat-and-filler&format=text";
            var para = "&paras=";
            var startWithLorem = '&start-with-lorem=';

            var paraStatus = 1;
            var startWithLoremStatus = 0;

            $(function(){
                $('#bacon_button').click(function() {

                    constructedUri = baconUri + para + paraStatus + startWithLorem + startWithLoremStatus;

                    console.log(constructedUri);

                    $.get( constructedUri, function( data ) {
                        console.log(data);
                        $('#bacon_text').val(data);
                        api.field.setValue(data);
                     });

                });
            });

            $("#bacon_text").on("input", function () {
                api.field.setValue(this.value);
            })

            $('#paraStatus').on('input', function () {
                paraStatus = this.value;
            })

            $('#paraStatus').on('input', function () {
                if (startWithLoremStatus == 0 ){
                    startWithLoremStatus =1;
                }else{
                    startWithLoremStatus = 0;
                }
            })

        })
    </script>
</body>

</html>
